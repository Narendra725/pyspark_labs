{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{},"variables":{},"resources":[{"name":"pl_model_refresh_schedule_test","type":"pipelines","apiVersion":"2018-06-01","properties":{"activities":[{"name":"SCI","type":"ForEach","dependsOn":[],"typeProperties":{"items":{"value":"@pipeline().parameters.SCI","type":"Expression"},"isSequential":false,"batchCount":2,"activities":[{"name":"Generic Model Refresh 0","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":1,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"15b3b45f-58dd-49a6-835a-e7ad586b4da5","workspaceId":"d9efac4c-e5ae-4015-ba5f-c6c5886f9a2f","parameters":{"dataset":{"value":{"value":"@item()","type":"Expression"},"type":"string"},"workspace":{"value":{"value":"@concat('ws_sci_sm_',pipeline().parameters.environment)","type":"Expression"},"type":"string"},"get_stats":{"value":{"value":"@pipeline().parameters.get_stats","type":"Expression"},"type":"bool"},"run_refresh":{"value":{"value":"@pipeline().parameters.run_refresh","type":"Expression"},"type":"bool"}}}},{"name":"SCI Status","type":"AppendVariable","dependsOn":[{"activity":"Generic Model Refresh 0","dependencyConditions":["Completed"]}],"typeProperties":{"variableName":"Model Status","value":{"value":"@activity('Generic Model Refresh 0').output.result.exitValue","type":"Expression"}}},{"name":"Teams Activity_copy1","type":"Teams","state":"Inactive","onInactiveMarkAs":"Succeeded","dependsOn":[{"activity":"SCI Status","dependencyConditions":["Completed"]}],"typeProperties":{"inputs":{"method":"post","path":"/beta/teams/conversation/message/poster/User/location/Group chat","body":{"recipient":"19:85e31bbcbd384d35b1500750304d1f6d@thread.v2","messageBody":"@concat(string('\n<table border=\"1\" style=\"border-collapse: collapse; border: 1px solid black;font-family: Calibri; font-size: 10px; width:120% ;color :#808080;\">  \t    \n<tr style=\"background-color:#1E454F\">   \n    <th><b><span style = \"color:#FFFFFF\"> ğŸ¢ Environment </span></b></th>         \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ—„ï¸ Dataset Name </span></b></th>   \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ” Refresh Type </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ—“ï¸ Refresh Date </span></b></th>  \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ•’ Start Time </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> âŒ› Duration </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ“ˆ Refresh Status </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ’¬ Remarks </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ“ Error Desc </span></b></th> \n</tr>'),string(json(activity('Generic Model Refresh 0').output.result.exitValue)))"}}}}]}},{"name":"Retail","type":"ForEach","dependsOn":[],"typeProperties":{"items":{"value":"@pipeline().parameters.RETAIL","type":"Expression"},"isSequential":false,"batchCount":7,"activities":[{"name":"Generic Model Refresh","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":1,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"15b3b45f-58dd-49a6-835a-e7ad586b4da5","workspaceId":"d9efac4c-e5ae-4015-ba5f-c6c5886f9a2f","parameters":{"dataset":{"value":{"value":"@item()","type":"Expression"},"type":"string"},"workspace":{"value":{"value":"@concat('ws_retail_sm_',pipeline().parameters.environment)","type":"Expression"},"type":"string"},"run_refresh":{"value":{"value":"@pipeline().parameters.run_refresh","type":"Expression"},"type":"bool"},"get_stats":{"value":{"value":"@pipeline().parameters.get_stats","type":"Expression"},"type":"bool"}}}},{"name":"Retail Status","type":"AppendVariable","dependsOn":[{"activity":"Generic Model Refresh","dependencyConditions":["Completed"]}],"typeProperties":{"variableName":"Model Status","value":{"value":"@activity('Generic Model Refresh').output.result.exitValue","type":"Expression"}}},{"name":"Teams Activity_copy1_copy1_copy6","type":"Teams","state":"Inactive","onInactiveMarkAs":"Succeeded","dependsOn":[{"activity":"Retail Status","dependencyConditions":["Completed"]}],"typeProperties":{"inputs":{"method":"post","path":"/beta/teams/conversation/message/poster/User/location/Group chat","body":{"recipient":"19:85e31bbcbd384d35b1500750304d1f6d@thread.v2","messageBody":"<p>&nbsp;ğŸ“Š Model Refresh Summary&nbsp; :</p>\n<p><br></p>\n<p>ğŸ¢Environment &nbsp;: @{toUpper(pipeline().parameters.environment)}</p>\n<p>ğŸ—„ï¸Dataset &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh').output.result.exitValue)['Semantic Model']}</p>\n<p>ğŸ” Refresh Type : @{json(activity('Generic Model Refresh').output.result.exitValue)['Refresh Type']}</p>\n<p>ğŸ—“ï¸ Refresh Date : @{json(activity('Generic Model Refresh').output.result.exitValue)['Refresh Date']}</p>\n<p>ğŸ•’ Start Time &nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh').output.result.exitValue)['Refresh Start Time (KSA)']}</p>\n<p>âŒ› Duration &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh').output.result.exitValue)['Duration']}</p>\n<p>ğŸ“ˆ Status &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh').output.result.exitValue)['Status'] }</p>\n<p>ğŸ’¬ Remarks &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;: @{json(activity('Generic Model Refresh').output.result.exitValue)['Remarks']}</p>\n<p>ğŸ“Error Desc &nbsp;&nbsp;: @{json(activity('Generic Model Refresh').output.result.exitValue)['Error Desc']}</p>\n<p><br></p>\n<p>**ğŸ‘‰ Sent From Fabric Datapipeline : Microsoft Automation<br>\n**</p>\n<p>Workspace : @{pipeline().DataFactory} &nbsp;Pipeline : @{pipeline().Pipeline}<br>\n</p>\n<p><br></p>"}}}}]}},{"name":"Clinics","type":"ForEach","dependsOn":[{"activity":"SCI","dependencyConditions":["Completed"]}],"typeProperties":{"items":{"value":"@pipeline().parameters.CLINICS","type":"Expression"},"isSequential":true,"activities":[{"name":"Generic Model Refresh 1","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":1,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"15b3b45f-58dd-49a6-835a-e7ad586b4da5","workspaceId":"d9efac4c-e5ae-4015-ba5f-c6c5886f9a2f","parameters":{"dataset":{"value":{"value":"@item()","type":"Expression"},"type":"string"},"workspace":{"value":{"value":"@concat('ws_clinics_sm_',pipeline().parameters.environment)","type":"Expression"},"type":"string"},"run_refresh":{"value":{"value":"@pipeline().parameters.run_refresh","type":"Expression"},"type":"bool"},"get_stats":{"value":{"value":"@pipeline().parameters.get_stats","type":"Expression"},"type":"bool"}}}},{"name":"Clinics Status","type":"AppendVariable","dependsOn":[{"activity":"Generic Model Refresh 1","dependencyConditions":["Completed"]}],"typeProperties":{"variableName":"Model Status","value":{"value":"@activity('Generic Model Refresh 1').output.result.exitValue","type":"Expression"}}},{"name":"Teams Activity_copy1_copy1","type":"Teams","state":"Inactive","onInactiveMarkAs":"Succeeded","dependsOn":[{"activity":"Clinics Status","dependencyConditions":["Completed"]}],"typeProperties":{"inputs":{"method":"post","path":"/beta/teams/conversation/message/poster/User/location/Group chat","body":{"recipient":"19:85e31bbcbd384d35b1500750304d1f6d@thread.v2","messageBody":"<p>&nbsp;ğŸ“Š Model Refresh Summary&nbsp; :</p>\n<p><br></p>\n<p>ğŸ¢Environment &nbsp;: @{toUpper(pipeline().parameters.environment)}</p>\n<p>ğŸ—„ï¸Dataset &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 1').output.result.exitValue)['Semantic Model']}</p>\n<p>ğŸ” Refresh Type : @{json(activity('Generic Model Refresh 1').output.result.exitValue)['Refresh Type']}</p>\n<p>ğŸ—“ï¸ Refresh Date : @{json(activity('Generic Model Refresh 1').output.result.exitValue)['Refresh Date']}</p>\n<p>ğŸ•’ Start Time &nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 1').output.result.exitValue)['Refresh Start Time (KSA)']}</p>\n<p>âŒ› Duration &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 1').output.result.exitValue)['Duration']}</p>\n<p>ğŸ“ˆ Status &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 1').output.result.exitValue)['Status'] }</p>\n<p>ğŸ’¬ Remarks &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 1').output.result.exitValue)['Remarks']}</p>\n<p>ğŸ“Error Desc &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 1').output.result.exitValue)['Error Desc']}</p>\n<p><br></p>\n<p>**ğŸ‘‰ Sent From Fabric Datapipeline : Microsoft Automation<br>\n**</p>\n<p>Workspace : @{pipeline().DataFactory} &nbsp;Pipeline : @{pipeline().Pipeline}<br>\n</p>\n<p><br></p>"}}}}]}},{"name":"Executive","type":"ForEach","state":"Inactive","onInactiveMarkAs":"Succeeded","dependsOn":[{"activity":"HR","dependencyConditions":["Completed"]}],"typeProperties":{"items":{"value":"@pipeline().parameters.EXECUTIVE","type":"Expression"},"isSequential":true,"activities":[{"name":"Generic Model Refresh 4","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":1,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"15b3b45f-58dd-49a6-835a-e7ad586b4da5","workspaceId":"d9efac4c-e5ae-4015-ba5f-c6c5886f9a2f","parameters":{"dataset":{"value":{"value":"@item()","type":"Expression"},"type":"string"},"workspace":{"value":{"value":"@concat('ws_executive_',pipeline().parameters.environment)","type":"Expression"},"type":"string"},"run_refresh":{"value":{"value":"@pipeline().parameters.run_refresh","type":"Expression"},"type":"bool"},"get_stats":{"value":{"value":"@pipeline().parameters.get_stats","type":"Expression"},"type":"bool"}}}},{"name":"Executive Status","type":"AppendVariable","dependsOn":[{"activity":"Generic Model Refresh 4","dependencyConditions":["Completed"]}],"typeProperties":{"variableName":"Model Status","value":{"value":"@activity('Generic Model Refresh 4').output.result.exitValue","type":"Expression"}}},{"name":"Teams Activity_copy1_copy1_copy4","type":"Teams","state":"Inactive","onInactiveMarkAs":"Succeeded","dependsOn":[{"activity":"Executive Status","dependencyConditions":["Completed"]}],"typeProperties":{"inputs":{"method":"post","path":"/beta/teams/conversation/message/poster/User/location/Group chat","body":{"recipient":"19:85e31bbcbd384d35b1500750304d1f6d@thread.v2","messageBody":"<p>&nbsp;ğŸ“Š Model Refresh Summary&nbsp; :</p>\n<p><br></p>\n<p>ğŸ¢Environment &nbsp;: @{toUpper(pipeline().parameters.environment)}</p>\n<p>ğŸ—„ï¸Dataset &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 4').output.result.exitValue)['Semantic Model']}</p>\n<p>ğŸ” Refresh Type : @{json(activity('Generic Model Refresh 4').output.result.exitValue)['Refresh Type']}</p>\n<p>ğŸ—“ï¸ Refresh Date : @{json(activity('Generic Model Refresh 4').output.result.exitValue)['Refresh Date']}</p>\n<p>ğŸ•’ Start Time &nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 4').output.result.exitValue)['Refresh Start Time (KSA)']}</p>\n<p>âŒ› Duration &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 4').output.result.exitValue)['Duration']}</p>\n<p>ğŸ“ˆ Status &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 4').output.result.exitValue)['Status'] }</p>\n<p>ğŸ’¬ Remarks &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 4').output.result.exitValue)['Remarks']}</p>\n<p>ğŸ“Error Desc &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 4').output.result.exitValue)['Error Desc']}</p>\n<p><br></p>\n<p>**ğŸ‘‰ Sent From Fabric Datapipeline : Microsoft Automation<br>\n**</p>\n<p>Workspace : @{pipeline().DataFactory} &nbsp;Pipeline : @{pipeline().Pipeline}<br>\n</p>\n<p><br></p>"}}}}]}},{"name":"Self Service","type":"ForEach","dependsOn":[{"activity":"Clinics","dependencyConditions":["Completed"]}],"typeProperties":{"items":{"value":"@pipeline().parameters.SELFSERVICE","type":"Expression"},"isSequential":true,"activities":[{"name":"Generic Model Refresh 3","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":1,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"15b3b45f-58dd-49a6-835a-e7ad586b4da5","workspaceId":"d9efac4c-e5ae-4015-ba5f-c6c5886f9a2f","parameters":{"dataset":{"value":{"value":"@item()","type":"Expression"},"type":"string"},"workspace":{"value":{"value":"@concat('ws_selfservice_sm_',pipeline().parameters.environment)","type":"Expression"},"type":"string"},"run_refresh":{"value":{"value":"@pipeline().parameters.run_refresh","type":"Expression"},"type":"bool"},"get_stats":{"value":{"value":"@pipeline().parameters.get_stats","type":"Expression"},"type":"bool"}}}},{"name":"SelfService Status","type":"AppendVariable","dependsOn":[{"activity":"Generic Model Refresh 3","dependencyConditions":["Completed"]}],"typeProperties":{"variableName":"Model Status","value":{"value":"@activity('Generic Model Refresh 3').output.result.exitValue","type":"Expression"}}},{"name":"Teams Activity_copy1_copy1_copy3","type":"Teams","state":"Inactive","onInactiveMarkAs":"Succeeded","dependsOn":[{"activity":"SelfService Status","dependencyConditions":["Completed"]}],"typeProperties":{"inputs":{"method":"post","path":"/beta/teams/conversation/message/poster/User/location/Group chat","body":{"recipient":"19:85e31bbcbd384d35b1500750304d1f6d@thread.v2","messageBody":"<p>&nbsp;ğŸ“Š Model Refresh Summary&nbsp; :</p>\n<p><br></p>\n<p>ğŸ¢Environment &nbsp;: @{toUpper(pipeline().parameters.environment)}</p>\n<p>ğŸ—„ï¸Dataset &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 3').output.result.exitValue)['Semantic Model']}</p>\n<p>ğŸ” Refresh Type : @{json(activity('Generic Model Refresh 3').output.result.exitValue)['Refresh Type']}</p>\n<p>ğŸ—“ï¸ Refresh Date : @{json(activity('Generic Model Refresh 3').output.result.exitValue)['Refresh Date']}</p>\n<p>ğŸ•’ Start Time &nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 3').output.result.exitValue)['Refresh Start Time (KSA)']}</p>\n<p>âŒ› Duration &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 3').output.result.exitValue)['Duration']}</p>\n<p>ğŸ“ˆ Status &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 3').output.result.exitValue)['Status'] }</p>\n<p>ğŸ’¬ Remarks &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 3').output.result.exitValue)['Remarks']}</p>\n<p>ğŸ“Error Desc &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 3').output.result.exitValue)['Error Desc']}</p>\n<p><br></p>\n<p>**ğŸ‘‰ Sent From Fabric Datapipeline : Microsoft Automation<br>\n**</p>\n<p>Workspace : @{pipeline().DataFactory} &nbsp;Pipeline : @{pipeline().Pipeline}<br>\n</p>\n<p><br></p>"}}}}]}},{"name":"IT","type":"ForEach","dependsOn":[{"activity":"Finance","dependencyConditions":["Completed"]}],"typeProperties":{"items":{"value":"@pipeline().parameters.IT","type":"Expression"},"isSequential":true,"activities":[{"name":"Generic Model Refresh 6","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":1,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"15b3b45f-58dd-49a6-835a-e7ad586b4da5","workspaceId":"d9efac4c-e5ae-4015-ba5f-c6c5886f9a2f","parameters":{"dataset":{"value":{"value":"@item()","type":"Expression"},"type":"string"},"workspace":{"value":{"value":"@concat('ws_it_sm_',pipeline().parameters.environment)","type":"Expression"},"type":"string"},"run_refresh":{"value":{"value":"@pipeline().parameters.run_refresh","type":"Expression"},"type":"bool"},"get_stats":{"value":{"value":"@pipeline().parameters.get_stats","type":"Expression"},"type":"bool"}}}},{"name":"IT Status","type":"AppendVariable","dependsOn":[{"activity":"Generic Model Refresh 6","dependencyConditions":["Completed"]}],"typeProperties":{"variableName":"Model Status","value":{"value":"@activity('Generic Model Refresh 6').output.result.exitValue","type":"Expression"}}},{"name":"Teams Activity_copy1_copy1_copy5","type":"Teams","state":"Inactive","onInactiveMarkAs":"Succeeded","dependsOn":[{"activity":"IT Status","dependencyConditions":["Completed"]}],"typeProperties":{"inputs":{"method":"post","path":"/beta/teams/conversation/message/poster/User/location/Group chat","body":{"recipient":"19:85e31bbcbd384d35b1500750304d1f6d@thread.v2","messageBody":"<p>&nbsp;ğŸ“Š Model Refresh Summary&nbsp; :</p>\n<p><br></p>\n<p>ğŸ¢Environment &nbsp;: @{toUpper(pipeline().parameters.environment)}</p>\n<p>ğŸ—„ï¸Dataset &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 6').output.result.exitValue)['Semantic Model']}</p>\n<p>ğŸ” Refresh Type : @{json(activity('Generic Model Refresh 6').output.result.exitValue)['Refresh Type']}</p>\n<p>ğŸ—“ï¸ Refresh Date : @{json(activity('Generic Model Refresh 6').output.result.exitValue)['Refresh Date']}</p>\n<p>ğŸ•’ Start Time &nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 6').output.result.exitValue)['Refresh Start Time (KSA)']}</p>\n<p>âŒ› Duration &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 6').output.result.exitValue)['Duration']}</p>\n<p>ğŸ“ˆ Status &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 6').output.result.exitValue)['Status'] }</p>\n<p>ğŸ’¬ Remarks &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 6').output.result.exitValue)['Remarks']}</p>\n<p>ğŸ“Error Desc &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 6').output.result.exitValue)['Error Desc']}</p>\n<p><br></p>\n<p>**ğŸ‘‰ Sent From Fabric Datapipeline : Microsoft Automation<br>\n**</p>\n<p>Workspace : @{pipeline().DataFactory} &nbsp;Pipeline : @{pipeline().Pipeline}<br>\n</p>\n<p><br></p>"}}}}]}},{"name":"HR","type":"ForEach","dependsOn":[{"activity":"SCI","dependencyConditions":["Completed"]}],"typeProperties":{"items":{"value":"@pipeline().parameters.HR","type":"Expression"},"isSequential":true,"activities":[{"name":"Generic Model Refresh 2","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":1,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"15b3b45f-58dd-49a6-835a-e7ad586b4da5","workspaceId":"d9efac4c-e5ae-4015-ba5f-c6c5886f9a2f","parameters":{"dataset":{"value":{"value":"@item()","type":"Expression"},"type":"string"},"workspace":{"value":{"value":"@concat('ws_hr_sm_',pipeline().parameters.environment)","type":"Expression"},"type":"string"},"run_refresh":{"value":{"value":"@pipeline().parameters.run_refresh","type":"Expression"},"type":"bool"},"get_stats":{"value":{"value":"@pipeline().parameters.get_stats","type":"Expression"},"type":"bool"}}}},{"name":"HR Status","type":"AppendVariable","dependsOn":[{"activity":"Generic Model Refresh 2","dependencyConditions":["Completed"]}],"typeProperties":{"variableName":"Model Status","value":{"value":"@activity('Generic Model Refresh 2').output.result.exitValue","type":"Expression"}}},{"name":"Teams Activity_copy1_copy1_copy1","type":"Teams","state":"Inactive","onInactiveMarkAs":"Succeeded","dependsOn":[{"activity":"HR Status","dependencyConditions":["Completed"]}],"typeProperties":{"inputs":{"method":"post","path":"/beta/teams/conversation/message/poster/User/location/Group chat","body":{"recipient":"19:85e31bbcbd384d35b1500750304d1f6d@thread.v2","messageBody":"<p>&nbsp;ğŸ“Š Model Refresh Summary&nbsp; :</p>\n<p><br></p>\n<p>ğŸ¢Environment &nbsp;: @{toUpper(pipeline().parameters.environment)}</p>\n<p>ğŸ—„ï¸Dataset &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 2').output.result.exitValue)['Semantic Model']}</p>\n<p>ğŸ” Refresh Type : @{json(activity('Generic Model Refresh 2').output.result.exitValue)['Refresh Type']}</p>\n<p>ğŸ—“ï¸ Refresh Date : @{json(activity('Generic Model Refresh 2').output.result.exitValue)['Refresh Date']}</p>\n<p>ğŸ•’ Start Time &nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 2').output.result.exitValue)['Refresh Start Time (KSA)']}</p>\n<p>âŒ› Duration &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 2').output.result.exitValue)['Duration']}</p>\n<p>ğŸ“ˆ Status &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 2').output.result.exitValue)['Status'] }</p>\n<p>ğŸ’¬ Remarks &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 2').output.result.exitValue)['Remarks']}</p>\n<p>ğŸ“Error Desc &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 2').output.result.exitValue)['Error Desc']}</p>\n<p><br></p>\n<p>**ğŸ‘‰ Sent From Fabric Datapipeline : Microsoft Automation<br>\n**</p>\n<p>Workspace : @{pipeline().DataFactory} &nbsp;Pipeline : @{pipeline().Pipeline}<br>\n</p>\n<p><br></p>"}}}}]}},{"name":"Finance","type":"ForEach","dependsOn":[{"activity":"SCI","dependencyConditions":["Completed"]}],"typeProperties":{"items":{"value":"@pipeline().parameters.FINANCE","type":"Expression"},"isSequential":true,"activities":[{"name":"Generic Model Refresh 5","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":1,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"15b3b45f-58dd-49a6-835a-e7ad586b4da5","workspaceId":"d9efac4c-e5ae-4015-ba5f-c6c5886f9a2f","parameters":{"dataset":{"value":{"value":"@item()","type":"Expression"},"type":"string"},"workspace":{"value":{"value":"@concat('ws_finance_sm_',pipeline().parameters.environment)","type":"Expression"},"type":"string"},"run_refresh":{"value":{"value":"@pipeline().parameters.run_refresh","type":"Expression"},"type":"bool"},"get_stats":{"value":{"value":"@pipeline().parameters.get_stats","type":"Expression"},"type":"bool"}}}},{"name":"Finance Status","type":"AppendVariable","dependsOn":[{"activity":"Generic Model Refresh 5","dependencyConditions":["Completed"]}],"typeProperties":{"variableName":"Model Status","value":{"value":"@activity('Generic Model Refresh 5').output.result.exitValue","type":"Expression"}}},{"name":"Teams Activity_copy1_copy1_copy2","type":"Teams","state":"Inactive","onInactiveMarkAs":"Succeeded","dependsOn":[{"activity":"Finance Status","dependencyConditions":["Completed"]}],"typeProperties":{"inputs":{"method":"post","path":"/beta/teams/conversation/message/poster/User/location/Group chat","body":{"recipient":"19:85e31bbcbd384d35b1500750304d1f6d@thread.v2","messageBody":"<p>&nbsp;ğŸ“Š Model Refresh Summary&nbsp; :</p>\n<p><br></p>\n<p>ğŸ¢Environment &nbsp;: @{toUpper(pipeline().parameters.environment)}</p>\n<p>ğŸ—„ï¸Dataset &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 5').output.result.exitValue)['Semantic Model']}</p>\n<p>ğŸ” Refresh Type : @{json(activity('Generic Model Refresh 5').output.result.exitValue)['Refresh Type']}</p>\n<p>ğŸ—“ï¸ Refresh Date : @{json(activity('Generic Model Refresh 5').output.result.exitValue)['Refresh Date']}</p>\n<p>ğŸ•’ Start Time &nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 5').output.result.exitValue)['Refresh Start Time (KSA)']}</p>\n<p>âŒ› Duration &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;: @{json(activity('Generic Model Refresh 5').output.result.exitValue)['Duration']}</p>\n<p>ğŸ“ˆ Status &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;: @{json(activity('Generic Model Refresh 5').output.result.exitValue)['Status'] }</p>\n<p>ğŸ’¬ Remarks &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 5').output.result.exitValue)['Remarks']}</p>\n<p>ğŸ“Error Desc &nbsp;&nbsp;: @{json(activity('Generic Model Refresh 5').output.result.exitValue)['Error Desc']}</p>\n<p><br></p>\n<p>**ğŸ‘‰ Sent From Fabric Datapipeline : Microsoft Automation<br>\n**</p>\n<p>Workspace : @{pipeline().DataFactory} &nbsp;Pipeline : @{pipeline().Pipeline}<br>\n</p>\n<p><br></p>"}}}}]}},{"name":"Set variable1","type":"SetVariable","dependsOn":[{"activity":"SCI","dependencyConditions":["Completed"]},{"activity":"Finance","dependencyConditions":["Completed"]},{"activity":"IT","dependencyConditions":["Completed"]},{"activity":"Retail","dependencyConditions":["Completed"]},{"activity":"HR","dependencyConditions":["Completed"]},{"activity":"Executive","dependencyConditions":["Completed"]},{"activity":"Clinics","dependencyConditions":["Completed"]},{"activity":"Self Service","dependencyConditions":["Completed"]}],"policy":{"secureOutput":false,"secureInput":false},"typeProperties":{"variableName":"temp_model_status","value":{"value":"@variables('Model Status')","type":"Expression"}}},{"name":"Teams Activity","type":"Teams","dependsOn":[{"activity":"Set variable1","dependencyConditions":["Completed"]}],"typeProperties":{"inputs":{"method":"post","path":"/beta/teams/conversation/message/poster/User/location/Group chat","body":{"recipient":"19:5a9011d4b88c4fecafe97cf485d6442a@thread.v2","messageBody":"@concat(string('\n<table border=\"1\" style=\"border-collapse: collapse; border: 1px solid black;font-family: Calibri; font-size: 10px; width:200% ;color :#808080;\">  \t    \n<tr style=\"background-color:#1E454F\">   \n    <th><b><span style = \"color:#FFFFFF\"> ğŸ‘¥ Workspace </span></b></th>         \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ—„ï¸ Dataset Name </span></b></th>   \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ” Refresh Type </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ—“ï¸ Refresh Date </span></b></th>  \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ•’ Start Time </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> âŒ› Duration </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ“ˆ Refresh Status </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ’¬ Remarks </span></b></th> \n\t<th><b><span style = \"color:#FFFFFF\"> ğŸ“ Error Desc </span></b></th> \n</tr>'),join(variables('temp_model_status'),''))"}}}}],"parameters":{"environment":{"type":"string","defaultValue":"prd"},"run_refresh":{"type":"bool","defaultValue":false},"get_stats":{"type":"bool","defaultValue":true},"SCI":{"type":"array","defaultValue":["Inventory_Semantic_Model","Supply Chain Semantic Model"]},"HR":{"type":"array","defaultValue":["HR Semantic Model"]},"CLINICS":{"type":"array","defaultValue":["Clinics Semantic Model"]},"FINANCE":{"type":"array","defaultValue":["Finance Semantic Model"]},"IT":{"type":"array","defaultValue":["IT Semantic Model"]},"SELFSERVICE":{"type":"array","defaultValue":["Self service semantic model"]},"EXECUTIVE":{"type":"array","defaultValue":["Executive Semantic Model"]},"RETAIL":{"type":"array","defaultValue":["Sales Semantic Model","Initiative Semantic Model","Quality Semantic Model","Global Semantic Model","Payment Semantic Model"]}},"variables":{"Model Status":{"type":"Array"},"temp_model_status":{"type":"Array"},"clinics_stats":{"type":"String"}},"lastModifiedByObjectId":"2da9bf4b-deb5-4208-9e1b-2ff11018ad46","lastPublishTime":"2025-11-03T12:41:50Z"},"dependsOn":[]}]}